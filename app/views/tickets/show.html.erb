<% provide(:title, @ticket.name) %>
<div class="previous-next">
  <% if @ticket.previous %>
    <%= link_to ticket_path(@ticket.previous.id), class:'previous' do %>
      <div class="d-flex align-items-center">
        <span><<</span>
        <div class="d-flex flex-column justify-content-center">
          <small><%= @ticket.user.name %></small>
          <small>の前のチケット</small>
        </div>
      </div>
    <% end %>
  <% end %>
  <% if @ticket.next %>
    <%= link_to ticket_path(@ticket.next.id), class:'next' do %>
      <div class="d-flex align-items-center">
        <div class="d-flex flex-column">
          <small><%= @ticket.user.name %></small>
          <small>の次のチケット</small>
        </div>
        <span>>></span>
      </div>
    <% end %>
  <% end %>
</div>
<div id="ticket-<%= @ticket.id %>" class="ticket-show" >
  <%= link_to user_path(@ticket.user), class: "user d-flex justify-content-center" do %>
    <%= image_tag @ticket.user.image.variant(resize:'50x50').processed, class:"avatar" %>
    <div class="user-name"><%= @ticket.user.name %></div>
  <% end %>
  <% if @ticket.public %>
    <h1 class="ticket-name mt-3"><%= @ticket.name %></h1>
  <% else %>
    <h1 class="ticket-name mt-3"><i class="fas fa-lock"></i><%= @ticket.name %></h1>
  <% end %>
  <div class="row">
    <div class="main-section col-lg-8">
      <div class="d-flex h-100px" >
        <%= render "likes/like", ticket: @ticket %>
        <% if @ticket.user == current_user %>
          <%= link_to '編集', edit_ticket_path(@ticket), remote: true, class: "edit-mark" %>
          <%= link_to '削除', @ticket, method: :delete, title: 'イベントの削除', class: "edit-mark", data: { confirm: '削除してよろしいですか？', commit: '削除', cancel: '中止' } %>
        <% end %>
      </div>
      <table>
        <tr>
          <td><i class="far fa-calendar-alt fa-2x"></i></td>
          <td class="ticket-column date"><%= @ticket.date.strftime("%Y/%-m/%-d %R") %></td>
        </tr>
        <tr>
          <td><i class="fas fa-user fa-2x"></i></td>
          <td class="ticket-column performer">
            <%= @ticket.performer%>
          </td>
        </tr>
        <tr>
          <td><i class="fas fa-map-marker-alt fa-2x"></i></td>
          <td class="ticket-column place"></i><%= @ticket.place %></td>
        </tr>
        <tr>
          <td><i class="fas fa-money-bill-wave-alt fa-2x"></i></td>
          <td class="ticket-column price"><%= @ticket.price %></td>
        </tr>
        <tr>
          <td><i class="fas fa-comment fa-2x"></i></td>
          <td class="ticket-column content"><%= simple_format(h(@ticket.content)) %></td>
        </tr>
      </table>
      <% if @ticket.images.attached? %>
        <% @ticket.images.each do |image| %>
          <%= image_tag image.variant(resize:'200x200').processed, class:"images" %>
        <% end %>
      <% end %>
    </div>
    <div class="col-lg-4 mt-5 side-section">
      <div class="weather-section mb-5">
        <%= render "shared/weather", ticket: @ticket %>
      </div>
      <div class="comment-section mt-3">
        <div class="comment-list">
          <h2><%= @comments.present? ? "コメント一覧" : "コメントはありません"  %></h2>
          <%= render @comments %>
          <%= paginate @comments %>
        </div>
        <div class="comment-form">
          <%= form_with model: [@ticket, @comment], local: true do |f| %>
            <%= f.text_area :content, class: "area" %>
            <br>
            <%= f.submit 'コメントする', class: "btn btn-primary btn-block" %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
